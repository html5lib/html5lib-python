[tox]
envlist = py{27,35,36,37,38,py,py3}-{base,six19,optional}
isolated_build = true

[testenv]
setenv =
  CFLAGS=-Og -g
deps =
  optional: -r{toxinidir}/requirements-optional.txt
  -r{toxinidir}/requirements-test.txt
  doc: Sphinx
changedir = {toxinidir}/tests/
passenv =
  PYTEST_COMMAND  # this is maintained so one can, e.g., PYTEST_COMMAND="coverage run -m pytest"
  COVERAGE_RUN_OPTIONS
commands =
  six19: pip install six==1.9
  {env:PYTEST_COMMAND:{envbindir}/py.test} --import-mode=append {posargs}
  #flake8 {toxinidir}

[testenv:doc]
changedir = doc
commands = sphinx-build -b html . _build
